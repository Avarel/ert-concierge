!function(e){function t(t){for(var n,a,r=t[0],l=t[1],d=t[2],h=0,u=[];h<r.length;h++)a=r[h],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&u.push(s[a][0]),s[a]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(c&&c(t);u.length;)u.shift()();return o.push.apply(o,d||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,r=1;r<i.length;r++){var l=i[r];0!==s[l]&&(n=!1)}n&&(o.splice(t--,1),e=a(a.s=i[0]))}return e}var n={},s={2:0},o=[];function a(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=n,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(i,n,function(t){return e[t]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var d=0;d<r.length;d++)t(r[d]);var c=l;o.push([8,1]),i()}([,,function(e,t){e.exports=BABYLON},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceEventHandler=t.EventHandler=void 0;class n{onReceive(e){var t,i,n,s,o,a,r;switch(e.type){case"MESSAGE":null===(t=this.onRecvMessage)||void 0===t||t.call(this,e);break;case"HELLO":null===(i=this.onRecvHello)||void 0===i||i.call(this,e);break;case"GROUP_SUBSCRIBERS":null===(n=this.onRecvGroupSubs)||void 0===n||n.call(this,e);break;case"GROUPS":null===(s=this.onRecvGroupList)||void 0===s||s.call(this,e);break;case"CLIENTS":null===(o=this.onRecvClientList)||void 0===o||o.call(this,e);break;case"SUBSCRIPTIONS":null===(a=this.onRecvSubscriptions)||void 0===a||a.call(this,e);break;case"STATUS":null===(r=this.onRecvStatus)||void 0===r||r.call(this,e)}}}t.EventHandler=n;t.ServiceEventHandler=class extends n{constructor(e,t){super(),this.subscribed=!1,this.client=e,this.group=t}onClose(e){this.onUnsubscribe()}onRecvHello(e){this.client.sendJSON({type:"FETCH_GROUP_SUBSCRIBERS",group:this.group})}onRecvGroupSubs(e){e.group==this.group&&this.subscribe(this.group)}subscribe(e){this.client.sendJSON({type:"SUBSCRIBE",group:e})}onRecvStatus(e){switch(e.code){case"NO_SUCH_GROUP":e.group==this.group&&console.error("Group `",this.group,"` does not exist on concierge.");break;case"GROUP_DELETED":e.group==this.group&&console.warn("Group `",this.group,"` has been deleted on the concierge.");break;case"GROUP_CREATED":e.group==this.group&&this.subscribe(this.group);break;case"SUBSCRIBED":e.group==this.group&&(console.log("Subscribed to `",this.group,"`."),this.subscribed=!0,this.onSubscribe());break;case"UNSUBSCRIBED":e.group==this.group&&(console.log("Unsubscribed from `",this.group,"`."),this.subscribed=!1,this.onUnsubscribe())}}}},,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Viewer=void 0,i(9);const n=i(11),s=i(12),o=i(13),a=i(14),r=i(21),l=i(22),d=i(23);var c;!function(e){new d.Drawer.UI(document.querySelector(".window#chat-window"));let t=new d.Drawer.UI(document.querySelector(".window#control-window"));e.start=function(){const e=new URLSearchParams(window.location.search);let i=e.get("server")||prompt("Enter the server address.","ws://127.0.0.1:64209/ws");if(!i||0==i.length)throw alert("Malformed server address!");let c=e.get("name")||prompt("Enter a username.");if(!c||0==c.length)throw alert("Malformed username!");let h=document.querySelector("canvas#renderCanvas");if(!h)throw"Canvas is not found!";h.focus();let u=new l.Renderer(h),p=new n.Client(c,i,!0),v=new s.PhysicsHandler(p,u);p.handlers.push(v);let b=new a.PlanetsHandler(p,u,t);p.handlers.push(b);let w=new d.Chat.UI(document.querySelector("#chat")),f=new o.ChatHandler(p,w);p.handlers.push(f);let m=new d.Sidebar.UI(document.querySelector(".sidebar#users")),y=new r.UsersHandler(p,m);p.handlers.push(y),u.start(),p.connect("0.1.1")}}(c=t.Viewer||(t.Viewer={})),c.start()},function(e,t,i){var n=i(0),s=i(10);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var o={insert:"head",singleton:!1};n(s,o);e.exports=s.locals||{}},function(e,t,i){(t=i(1)(!1)).push([e.i,"body{height:100vh;width:100vw;overflow:hidden}#renderCanvas{width:100%;height:100%;touch-action:none}",""]),e.exports=t},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;class n{constructor(e,t,i=!1){this.seq=0,this.reconnectInterval=1e4,this.handlers=[],this.url=t,this.name=e,this.reconnect=i}connect(e,t){console.info("Trying to connect to ",this.url),this.version=e,this.secret=t,this.socket=new WebSocket(this.url,"ert-concierge"),this.socket.onopen=e=>this.onOpen(e),this.socket.onmessage=e=>this.onReceive(e),this.socket.onerror=e=>this.onError(e),this.socket.onclose=e=>this.onClose(e)}sendJSON(e){if(null==this.socket)throw new Error("Socket is not connected");this.socket.send(JSON.stringify(e));let t=this.seq;return this.seq+=1,t}close(e,t,i=!0){if(null==this.socket)throw new Error("Socket is not connected");this.socket.close(e,t),i?this.tryReconnect():(this.socket=void 0,this.version=void 0,this.secret=void 0)}tryReconnect(){this.reconnect&&(console.warn("Connection closed, reconnecting in",this.reconnectInterval,"ms"),setTimeout(()=>{this.connect(this.version,this.secret)},this.reconnectInterval))}onOpen(e){var t;for(let i of this.handlers)null===(t=i.onOpen)||void 0===t||t.call(i,e);if(null==this.version)throw new Error("Version is undefined");console.log("Identifying with version",this.version),this.sendJSON({type:"IDENTIFY",name:this.name,version:this.version,secret:this.secret,tags:["babylon"]})}onClose(e){var t;for(let i of this.handlers)null===(t=i.onClose)||void 0===t||t.call(i,e);console.warn(e.code,e.reason),this.tryReconnect()}onReceive(e){var t;let i=JSON.parse(e.data);if(i.hasOwnProperty("type")){let e=i;"HELLO"==e.type&&(console.log("Assigned uuid",e.uuid),this.uuid=e.uuid,this.seq=0);for(let i of this.handlers)null===(t=i.onReceive)||void 0===t||t.call(i,e)}}onError(e){var t;for(let i of this.handlers)null===(t=i.onError)||void 0===t||t.call(i,e);console.log(e)}}t.Client=n,t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhysicsHandler=t.PHYSICS_ENGINE_GROUP=t.PHYSICS_ENGINE_NAME=void 0;const n=i(2),s=i(3);function o(e){return new n.Vector2(e.x-500,e.y-500)}function a(e){function t(e){return Math.max(0,Math.min(e,255))/255}return new n.Color3(t(e[0]),t(e[1]),t(e[2]))}t.PHYSICS_ENGINE_NAME="physics_engine",t.PHYSICS_ENGINE_GROUP="physics_engine_out";class r{constructor(e,t){this.centroid=e,this.mesh=t}static createPolygon(e,t,i,s,o=1){let a=t.map(e=>e.scaleInPlace(o)),l=new n.PolygonMeshBuilder("polytri",a,i).build(void 0,50*o);l.position.y+=50*o;var d=new n.StandardMaterial("myMaterial",i);return d.diffuseColor=s,l.material=d,l.actionManager=new n.ActionManager(i),new r(e.scaleInPlace(o),l)}setColor(e){this.mesh.material.diffuseColor=e}moveTo(e){let t=e.subtract(this.centroid);this.mesh.position.addInPlace(t),this.centroid.set(e.x,e.y,e.z)}}class l extends s.ServiceEventHandler{constructor(e,i){super(e,t.PHYSICS_ENGINE_GROUP),this.shapes=new Map,this.visualScale=.02,this.client=e,this.renderer=i}onRecvMessage(e){e.origin.name==t.PHYSICS_ENGINE_NAME&&this.processPhysicsPayload(e.data)}onSubscribe(){console.log("Fetching..."),this.client.sendJSON({type:"MESSAGE",target:{type:"NAME",name:t.PHYSICS_ENGINE_NAME},data:{type:"FETCH_ENTITIES"}})}onUnsubscribe(){this.clearShapes()}clearShapes(){for(let e of this.shapes.keys())if(this.shapes.has(e)){this.shapes.get(e).mesh.dispose(),this.shapes.delete(e)}}createPolygon(e,t,i,s){if(this.renderer.scene){let o=r.createPolygon(new n.Vector3(t.x,0,t.y),i,this.renderer.scene,s,this.visualScale);return this.shapes.set(e,o),o}throw new Error("Scene not initialized!")}createShape(e,i,s,r){let l=o(i),d=s.map(o),c=a(r);this.createPolygon(e,l,d,c).mesh.actionManager.registerAction(new n.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,()=>{console.log("Clicking on object ",e,"."),this.client.sendJSON({type:"MESSAGE",target:{type:"NAME",name:t.PHYSICS_ENGINE_NAME},data:{type:"TOGGLE_COLOR",id:e}})}))}updateShape(e,t){let i=this.shapes.get(e);if(i){let e=o(t);i.moveTo(new n.Vector3(e.x,0,e.y).scaleInPlace(this.visualScale))}}updateColor(e,t){let i=this.shapes.get(e);i&&i.setColor(a(t))}processPhysicsPayload(e){switch(e.type){case"ENTITY_DUMP":console.log("Dumping entities!"),this.clearShapes();for(let t of e.entities)this.createShape(t.id,t.centroid,t.points,t.color);break;case"POSITION_DUMP":for(let t of e.updates)this.updateShape(t.id,t.position);break;case"COLOR_UPDATE":this.updateColor(e.id,e.color)}}}t.PhysicsHandler=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatHandler=void 0;const n=i(3);class s extends n.ServiceEventHandler{constructor(e,t){super(e,"chat"),this.client=e,this.ui=t,t.onEnter=e=>{this.onEnter(e)}}onSubscribe(){this.ui.addStatus("Connected to the chat system.")}onEnter(e){this.client.sendJSON({type:"MESSAGE",target:{type:"GROUP",group:"chat"},data:e})}onRecvMessage(e){e.origin&&"chat"==e.origin.group&&"string"==typeof e.data&&this.ui.addMessage(e.origin.name,e.data,e.origin.name==this.client.name)}onUnsubscribe(){this.ui.addStatus("Disconnected from the chat system.")}}t.ChatHandler=s},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function r(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,r)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlanetsHandler=exports.PLANET_SIM_GROUP=exports.PLANET_SIM_NAME=void 0,__webpack_require__(15);const babylonjs_1=__webpack_require__(2),handlers_1=__webpack_require__(3);exports.PLANET_SIM_NAME="planetary_simulation",exports.PLANET_SIM_GROUP="planetary_simulation_out";let controls_template=__webpack_require__(17),system_info_template=__webpack_require__(19),planet_info_template=__webpack_require__(20);function htmlToElement(e){var t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}class Planet{constructor(e,t,i,n){this.id=e,this.centroid=t,this.mesh=i,this.trailMesh=n}static create(e,t,i,n,s,o=1){let a=babylonjs_1.MeshBuilder.CreateSphere("mySphere",{diameter:2*i*o},n);a.position=t;var r=new babylonjs_1.StandardMaterial("myMaterial",n);r.diffuseColor=s,a.material=r,a.actionManager=new babylonjs_1.ActionManager(n);let l=new babylonjs_1.TrailMesh("trail",a,n,Math.min(.02,i*o),1e3,!0);return new Planet(e,t,a,l)}dispose(){var e;this.unhookHover(),null===(e=this.trailMesh)||void 0===e||e.dispose(),this.mesh.dispose()}hookHover(e){this.mesh.actionManager&&(this.enterAction=new babylonjs_1.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOverTrigger,()=>{e.hover(this.id),e.update()}),this.exitAction=new babylonjs_1.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOutTrigger,()=>{e.unhover(this.id),e.update()}),this.clickAction=new babylonjs_1.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,()=>{e.getLock()==this.id?e.unlock():e.lock(this.id),e.update()}),this.mesh.actionManager.registerAction(this.enterAction),this.mesh.actionManager.registerAction(this.exitAction),this.mesh.actionManager.registerAction(this.clickAction))}unhookHover(){this.mesh.actionManager&&(this.enterAction&&(this.mesh.actionManager.unregisterAction(this.enterAction),this.enterAction=void 0),this.exitAction&&(this.mesh.actionManager.unregisterAction(this.exitAction),this.exitAction=void 0),this.clickAction&&(this.mesh.actionManager.unregisterAction(this.clickAction),this.clickAction=void 0))}setColor(e){this.mesh.material.diffuseColor=e}moveTo(e){let t=e.subtract(this.centroid);this.mesh.position.addInPlace(t),this.centroid.set(e.x,e.y,e.z)}}class PlanetsHandler extends handlers_1.ServiceEventHandler{constructor(e,t,i){super(e,exports.PLANET_SIM_GROUP),this.visualScale=5,this.client=e,this.renderer=t,this.planets=new Map,this.drawerUI=i}onRecvMessage(e){e.origin.name==exports.PLANET_SIM_NAME&&this.processPlanetsPayload(e.data)}sendToSim(e){this.client.sendJSON({type:"MESSAGE",target:{type:"NAME",name:exports.PLANET_SIM_NAME},data:e})}onSubscribe(){var e;this.controllerElement=htmlToElement(controls_template()),this.infoHandler=new PlanetInfoHandler(this,this.controllerElement.querySelector(".planetary-controls .info")),this.setupController(this.controllerElement),null===(e=this.drawerUI)||void 0===e||e.addTab(exports.PLANET_SIM_NAME,"Planetary Controls",this.controllerElement),console.log("Planet simulator client is ready to go!"),this.sendToSim({type:"FETCH_SYSTEM_DATA"})}setupController(e){var t,i,n,s,o;null===(t=e.querySelector(".planetary-pause"))||void 0===t||t.addEventListener("click",()=>{this.sendToSim({type:"PAUSE"})}),null===(i=e.querySelector(".planetary-play"))||void 0===i||i.addEventListener("click",()=>{this.sendToSim({type:"PLAY"})}),null===(n=e.querySelector(".planetary-sf"))||void 0===n||n.addEventListener("click",()=>{this.sendToSim({type:"STEP_FORWARD"})}),null===(s=e.querySelector(".planetary-ff"))||void 0===s||s.addEventListener("click",()=>{this.sendToSim({type:"FAST_FORWARD"})}),null===(o=e.querySelector(".planetary-fb"))||void 0===o||o.addEventListener("click",()=>{this.sendToSim({type:"FAST_BACKWARD"})});let a=e.querySelector(".planetary-upload");null==a||a.addEventListener("submit",e=>{e.preventDefault();let t=new FormData(a),i=new URL(window.location.href);i.port="64209",this.upload(i,t)})}upload(e,t){return __awaiter(this,void 0,void 0,(function*(){const i=new URL(`/fs/${this.client.name}/system.json`,e),n=new Headers;n.append("x-fs-key",this.client.uuid);const s=yield fetch(i.toString(),{method:"POST",headers:n,body:t});switch(s.status){case 200:case 201:this.sendToSim({type:"LOAD_SYSTEM",url:i.toString()});break;default:alert("Unexpected response:"+s.status+" "+s.statusText)}}))}onUnsubscribe(){var e,t,i;null===(e=this.drawerUI)||void 0===e||e.removeTab(exports.PLANET_SIM_NAME),null===(t=this.controllerElement)||void 0===t||t.remove(),this.clearShapes(),null===(i=this.infoHandler)||void 0===i||i.clear(),this.infoHandler=void 0,console.log("Planet simulator client has disconnected!")}clearShapes(){for(let e of this.planets.keys()){const t=this.planets.get(e);t&&(t.dispose(),this.planets.delete(e))}}processPlanetsPayload(e){switch(e.type){case"SYSTEM_REMOVE_PLANETS":for(const t of e.ids){let e=this.planets.get(t);e&&(e.dispose(),this.planets.delete(t))}break;case"SYSTEM_DATA_DUMP":this.sysData=e.data,this.clearShapes(),this.sendToSim({type:"FETCH_SYSTEM_OBJS"}),this.infoHandler.update();break;case"SYSTEM_OBJS_DUMP":if(null==this.sysData)return;for(let t of e.objects){let e=new babylonjs_1.Vector3(t.location[0],t.location[1],t.location[2]).scaleInPlace(1/this.sysData.scale).scaleInPlace(this.visualScale);if(this.planets.has(t.name)){let i=this.planets.get(t.name);i.moveTo(e),i.data=t}else{if(!this.renderer.scene)throw new Error("Scene not initialized!");{let i=t.radius/this.sysData.scale*this.sysData.bodyScale*this.visualScale,n=babylonjs_1.Color3.FromArray(t.color);t.name==this.sysData.centralBodyName&&(console.log("Found central body!"),i*=this.sysData.centralBodyScale,e.scaleInPlace(this.sysData.centralBodyScale));let s=Planet.create(t.name,e,i,this.renderer.scene,n);this.infoHandler&&s.hookHover(this.infoHandler),s.data=t,this.planets.set(t.name,s)}}}this.infoHandler.update();break;case"SYSTEM_CLEAR":console.log("Clearing shapes"),this.infoHandler.clear(),this.clearShapes()}}}var InfoPaneType;exports.PlanetsHandler=PlanetsHandler,function(e){e[e.None=0]="None",e[e.System=1]="System",e[e.Planet=2]="Planet"}(InfoPaneType||(InfoPaneType={}));class PlanetInfoHandler{constructor(e,t){this.infoPaneType=InfoPaneType.None,this.hoveredPlanets=new Set,this.lockedInputs=[],this.handler=e,this.rootElement=t}getLock(){return this.planetLock}lock(e){this.planetLock=e}unlock(){this.planetLock=void 0}hover(e){this.hoveredPlanets.add(e)}unhover(e){this.hoveredPlanets.delete(e)}clear(){this.hoveredPlanets.clear(),this.planetLock=void 0,this.rootElement.innerHTML="",this.infoPaneType=InfoPaneType.None}update(){if(this.planetLock){let e=this.handler.planets.get(this.planetLock);this.updateInfoPlanet(e)}else if(0!=this.hoveredPlanets.size){let e=this.hoveredPlanets.values().next(),t=this.handler.planets.get(e.value);this.updateInfoPlanet(t)}else this.updateInfoSystem(this.handler.sysData)}unlitPlanet(e){e&&(e.mesh.material.emissiveColor=babylonjs_1.Color3.Black(),this.littedPlanet=void 0)}litPlanet(e){e&&(e.mesh.material.emissiveColor=babylonjs_1.Color3.Red(),this.littedPlanet=e.id)}updateInfoPlanet(e){if(this.littedPlanet&&this.littedPlanet!=e.id){let e=this.handler.planets.get(this.littedPlanet);this.unlitPlanet(e)}this.infoPaneType!=InfoPaneType.Planet?(this.rootElement.innerHTML=planet_info_template(),this.setupInputFields(e.id),this.infoPaneType=InfoPaneType.Planet):this.inputTarget!=e.id&&this.setupInputFields(e.id),this.updateInputFields(e.data),this.litPlanet(e)}updateInfoSystem(e){if(this.littedPlanet){this.handler.planets.get(this.littedPlanet).mesh.material.emissiveColor=babylonjs_1.Color3.Black(),this.littedPlanet=void 0}this.infoPaneType!=InfoPaneType.System&&(this.rootElement.innerHTML=system_info_template(),this.setupInputFields("system"),this.infoPaneType=InfoPaneType.System),this.updateInputFields(e)}setupInputFields(e){for(const t of this.rootElement.querySelectorAll("input")){let i=t.getAttribute("var");i&&(t.onkeydown=n=>{13===n.keyCode&&(n.preventDefault(),this.handler.sendToSim({type:"UPDATE_DATA",target:e,field:i,value:t.value}))})}this.inputTarget=e}updateInputFields(obj){if(obj){clearTimeout(this.unlockAction);for(const elem of this.rootElement.querySelectorAll("input,[var]")){let attr=elem.getAttribute("var");if(attr)if("INPUT"==elem.nodeName){let input=elem;input.value=eval("obj."+attr),"always"!=elem.getAttribute("readonly")&&(input.readOnly=!0,this.lockedInputs.push(input))}else elem.textContent=eval("obj."+attr)}this.unlockAction=window.setTimeout(()=>{for(const e of this.lockedInputs)e.readOnly=!1;this.lockedInputs.length=0},200)}}}},function(e,t,i){var n=i(0),s=i(16);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var o={insert:"head",singleton:!1};n(s,o);e.exports=s.locals||{}},function(e,t,i){(t=i(1)(!1)).push([e.i,'.planetary-controls{position:relative;width:100%;height:100%;font-family:"Titillium Web","Roboto",sans-serif;box-sizing:border-box;overflow:auto}.planetary-controls .planetary-upload{display:flex}.planetary-controls .planetary-upload input[type=file]{flex:1 0 auto}.planetary-controls .icons{border-radius:5px;background:#fff;padding:10px;font-size:30px;position:relative;text-align:center;display:flex;justify-content:space-evenly;color:#aaa}.planetary-controls .icons i{transition:transform .2s;cursor:pointer}.planetary-controls .icons i:hover{transform:scale(1.2)}.planetary-controls .info{padding:10px}.planetary-controls .info>.name .value{text-transform:uppercase;font-size:30px;font-weight:bold;margin-bottom:20px}.planetary-controls .info>.entry{display:flex;margin-bottom:5px}.planetary-controls .info>.entry>.name{width:40%;text-align:right;padding-right:10px;box-sizing:border-box}.planetary-controls .info>.entry>.value{flex:1 0 auto;display:flex;flex-direction:column}.planetary-controls .info>.entry>.value input{font-family:inherit;width:100%;padding:5px;box-sizing:border-box;border:none;background:#fff;text-align:right;transition:background-color .2s}.planetary-controls .info>.entry>.value input:read-only{background:#eee;outline:none}.planetary-controls .info>.entry>.value input:first-child{border-radius:5px 5px 0 0}.planetary-controls .info>.entry>.value input:not(:first-child):not(:last-child){border-radius:0}.planetary-controls .info>.entry>.value input:not(:last-child){margin-bottom:1px}.planetary-controls .info>.entry>.value input:last-child{border-radius:0 0 5px 5px}.planetary-controls .info>.entry>.value input:first-child:last-child{border-radius:5px}',""]),e.exports=t},function(e,t,i){i(4);e.exports=function(e){var t="";return t+='<div class="window-tab planetary-controls"><div class="header"><div class="icons"><i class="fa fa-fast-backward planetary-fb"></i><i class="fa fa-pause planetary-pause"></i><i class="fa fa-play planetary-play"></i><i class="fa fa-step-forward planetary-sf"></i><i class="fa fa-fast-forward planetary-ff"></i></div><div class="info"></div></div><div class="body"><div class="box"><h1>Upload JSON System</h1><form class="planetary-upload"><input class="file" type="file" name="file"><button type="submit">Submit</button></form></div><div class="box"><h1>Planetary Simulation</h1><p>Python Simulation by Alison Noyes</p><p>BabylonJS frontend by An Tran</p></div></div></div>'}},function(e,t){},function(e,t,i){i(4);e.exports=function(e){var t="";return t+='<div class="name"> <div class="value">System</div></div><div class="entry"><div class="name">Gravity Constant</div><div class="value"><input var="gravityConstant"></div></div><div class="entry"><div class="name">Scale</div><div class="value"><input var="scale"></div></div><div class="entry"><div class="name">Time Scale</div><div class="value"><input var="timeScale" readonly="always"></div></div><div class="entry"><div class="name">Body Scale</div><div class="value"><input var="bodyScale"></div></div><div class="entry"><div class="name">Central Body Scale</div><div class="value"><input var="centralBodyScale"></div></div><div class="entry"><div class="name">Elasticity</div><div class="value"><input var="elasticity"></div></div><div class="entry"><div class="name">Central Body Name</div><div class="value"><input var="centralBodyName" readonly="always"></div></div><div class="entry"><div class="name">Hand Mass</div><div class="value"><input var="handMass" readonly="always"></div></div><div class="entry"><div class="name">Boundary</div><div class="value"><input var="boundary"></div></div>'}},function(e,t,i){i(4);e.exports=function(e){var t="";return t+='<div class="name"><div class="value" var="name"></div></div><div class="entry"><div class="name">Mass</div><div class="value"><input var="mass"></div></div><div class="entry"><div class="name">Radius</div><div class="value"><input var="radius"></div></div><div class="entry"><div class="name">Location</div><div class="value"><input var="location[0]"><input var="location[1]"><input var="location[2]"></div></div><div class="entry"><div class="name">Orbit Radius</div><div class="value"><input var="orbitRadius"></div></div><div class="entry"><div class="name">Orbit Speed</div><div class="value"><input var="orbitSpeed"></div></div><div class="entry"><div class="name">Direction</div><div class="value"><input var="direction[0]" readonly="always"><input var="direction[1]" readonly="always"><input var="direction[2]" readonly="always"></div></div>'}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UsersHandler=void 0;const n=i(3);class s extends n.EventHandler{constructor(e,t){super(),this.client=e,this.ui=t}onClose(e){this.ui.clear()}onRecvHello(e){this.client.sendJSON({type:"FETCH_CLIENTS"})}onRecvClientList(e){this.ui.clear();for(let t of e.clients)this.ui.addInitialIcon(t.name,t.nickname||t.name,t.name[0])}onRecvStatus(e){switch(e.code){case"CLIENT_JOINED":this.ui.addInitialIcon(e.name,e.nickname||e.name,e.name[0]);break;case"CLIENT_LEFT":this.ui.removeIcon(e.name)}}}t.UsersHandler=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;const n=i(2),s=i(2);t.Renderer=class{constructor(e){this.canvas=e,this.engine=new n.Engine(e,!0)}createScene(){this.scene&&this.scene.dispose();let e=new n.Scene(this.engine),t=new n.UniversalCamera("UniversalCamera",new s.Vector3(0,10,-10),e);t.setTarget(new s.Vector3(0,0,0)),t.attachControl(this.canvas,!0),t.speed=.5,t.keysDownward.push(17),t.keysUpward.push(32),t.keysUp.push(87),t.keysDown.push(83),t.keysLeft.push(65),t.keysRight.push(68),new n.PointLight("light1",new n.Vector3(0,500,0),e).intensity=1;let i=e.createDefaultEnvironment({skyboxSize:500,groundSize:500,groundShadowLevel:.5,enableGroundShadow:!0});i.skybox.isPickable=!1,i.setMainColor(n.Color3.FromHexString("#909090")),e.createDefaultVRExperience({createDeviceOrientationCamera:!1}).enableTeleportation({floorMeshes:[i.ground]}),this.scene=e}start(){null==this.scene&&this.createScene();let e=()=>{this.scene?this.scene.render():this.engine.stopRenderLoop(e)};this.engine.runRenderLoop(e),window.addEventListener("resize",()=>{this.engine.resize()})}stop(){this.engine.stopRenderLoop()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Drawer=t.Sidebar=t.Chat=void 0;const n=i(24);t.Chat=n.default;const s=i(27);t.Sidebar=s.default;const o=i(32);t.Drawer=o.default},function(e,t,i){"use strict";function n(e,t=[]){let i=document.createElement(e);return i.classList.add(...t),i}var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Chat=void 0,i(25),function(e){e.UI=class{constructor(e){this.messages=[],this.rootElement=e,this.setup()}setup(){let e=this.rootElement.querySelector("div.messages")||n("div",["messages"]),t=this.rootElement.querySelector("div.input")||n("div",["input"]),i=t.querySelector("input")||n("input");t.appendChild(i);let s=t.querySelector("div.button")||n("div",["button"]);t.appendChild(s),i.addEventListener("keydown",e=>{13===e.keyCode&&(e.preventDefault(),s.click())}),s.addEventListener("click",e=>{var t;i.value.length>0&&(null===(t=this.onEnter)||void 0===t||t.call(this,i.value),i.value="")}),this.messagesElement=e,this.rootElement.appendChild(e),this.rootElement.appendChild(t)}createMessageElement(e,t,i=!1){let s=n("div",i?["entry","you"]:["entry"]),o=n("div",["name"]);o.innerText=e;let a=n("div",["text"]);return a.innerText=t,s.appendChild(o),s.appendChild(a),s}createStatusElement(e){let t=n("div",["entry","status"]),i=n("div",["text"]);return i.innerText=e,t.appendChild(i),t}addStatus(e){let t=this.createStatusElement(e);this.messagesElement.appendChild(t),this.messagesElement.scrollTop=this.messagesElement.scrollHeight}addMessage(e,t,i=!1){let n=this.createMessageElement(e,t,i);this.messagesElement.appendChild(n),this.messages.push({name:e,text:t,element:n}),this.messagesElement.scrollTop=this.messagesElement.scrollHeight}}}(s=t.Chat||(t.Chat={})),t.default=s},function(e,t,i){var n=i(0),s=i(26);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var o={insert:"head",singleton:!1};n(s,o);e.exports=s.locals||{}},function(e,t,i){(t=i(1)(!1)).push([e.i,'#chat{background:#ccc;color:#000;height:100%;display:flex;flex-direction:column;font-family:"Titillium Web","Roboto",sans-serif}#chat .input{position:relative;display:flex;width:100%;height:0px;bottom:50px;background:#aaa;padding-left:10px;padding-right:10px;box-sizing:border-box}#chat .input input{background:#aaa;border:0;padding:5px;box-sizing:border-box;height:40px;width:100%;border-radius:5px;margin-right:5px;outline:none;font-family:"Titillium Web","Roboto",sans-serif}#chat .input .button{line-height:40px;text-align:center;line-height:40px;height:40px;width:40px;box-sizing:border-box;border-radius:5px;background:#fff;user-select:none;cursor:pointer}#chat .input .button:hover{background:#eee}#chat .messages{padding:15px;height:100%;width:100%;box-sizing:border-box;display:flex;flex-direction:column;position:relative;overflow:auto}#chat .messages::-webkit-scrollbar{width:10px}#chat .messages::-webkit-scrollbar-track{background:transparent}#chat .messages::-webkit-scrollbar-thumb{background:#aaa;border-radius:5px}#chat .messages::-webkit-scrollbar-thumb:hover{background:#bbb}#chat .messages .entry{display:flex;max-width:90%;flex-direction:column;align-self:flex-start}#chat .messages .entry:last-child{margin-bottom:40px}#chat .messages .entry.you{align-self:flex-end}#chat .messages .entry.you .name{text-align:right}#chat .messages .entry.you .text{border-radius:5px 0px 5px 5px;align-self:flex-end}#chat .messages .entry.status{width:100%;max-width:100%}#chat .messages .entry.status .text{text-align:center;background:none;margin:0;padding:0;color:#888}#chat .messages .entry .name{text-align:left;margin:10px 10px 0px}#chat .messages .entry .text{border-radius:0 5px 5px;background:#fff;padding:10px;word-break:break-all;margin:5px}',""]),e.exports=t},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sidebar=void 0,i(28);const n=i(35);function s(e,t=[]){let i=document.createElement(e);return i.classList.add(...t),i}var o;i(30),function(e){class t{constructor(e,t,i){this.id=e,this.element=t,this.tooltip=i}destroy(){this.element.remove(),this.tooltip.destroy()}}e.Icon=t;class i{constructor(e){this.icons=[],this.rootElement=e}baseIcon(){return s("div",["icon"])}static hashString(e){var t,i=0;for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i}clear(){for(let e of this.icons)e.destroy();this.icons.length=0}addImageIcon(e,i,o){let a=this.baseIcon(),r=n.default(a,{placement:"right",content:i}),l=s("img");l.setAttribute("src",o),a.appendChild(l),this.rootElement.appendChild(a),this.icons.push(new t(e,a,r))}addInitialIcon(e,o,a){let r=this.baseIcon(),l=n.default(r,{placement:"right",content:o}),d=s("p");d.innerText=a.toUpperCase(),r.appendChild(d);let c=i.hashString(o)%360;d.style.backgroundColor=`hsl(${c}, 100%, 25%)`,this.rootElement.appendChild(r),this.icons.push(new t(e,r,l))}removeIcon(e){for(let t=0;t<this.icons.length;t++){let i=this.icons[t];i.id==e&&(i.destroy(),this.icons.splice(t,1))}}}e.UI=i}(o=t.Sidebar||(t.Sidebar={})),t.default=o},function(e,t,i){var n=i(0),s=i(29);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var o={insert:"head",singleton:!1};n(s,o);e.exports=s.locals||{}},function(e,t,i){(t=i(1)(!1)).push([e.i,'.sidebar{position:fixed;z-index:100;top:0;left:0;flex-direction:column;display:flex;overflow:auto;width:70px;height:100%;padding:15px}.sidebar::-webkit-scrollbar{width:5px}.sidebar::-webkit-scrollbar-track{background:transparent}.sidebar::-webkit-scrollbar-thumb{background:#444;border-radius:5px}.sidebar::-webkit-scrollbar-thumb:hover{background:#555}.sidebar .icon{flex:0 0 auto;width:70px;height:70px;margin-bottom:10px;box-sizing:border-box;position:relative}.sidebar .icon:hover .tooltip{visibility:visible;opacity:1}.sidebar .icon .tooltip{background-color:#555;border-radius:5px;color:#fff;font-family:monospace;margin-left:-10px;margin-top:5px;opacity:0;padding:5px 0;position:absolute;text-align:center;transition:opacity .2s;visibility:hidden;width:calc(100% + 20px);word-break:break-all;z-index:101}.sidebar .icon .tooltip::after{content:"";position:absolute;bottom:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:transparent transparent #555 transparent}.sidebar .icon img,.sidebar .icon p{height:100%;width:100%;background:#000;border-radius:50%;cursor:pointer;transition:border-radius .2s}.sidebar .icon img:hover,.sidebar .icon p:hover{border-radius:10px}.sidebar .icon p{color:#fff;line-height:70px;text-align:center;font-size:40px;font-family:"Titillium Web","Roboto",sans-serif;user-select:none}.tippy-box{font-family:"Titillium Web","Roboto",sans-serif !important}',""]),e.exports=t},,,function(e,t,i){"use strict";function n(e,t=[]){let i=document.createElement(e);return i.classList.add(...t),i}var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Drawer=void 0,i(33),function(e){class t{constructor(e,t,i){this.tag=e,this.header=t,this.body=i}show(e=!0){e?(this.header.classList.add("active"),this.body.classList.add("active")):(this.header.classList.remove("active"),this.body.classList.remove("active"))}}e.Tab=t;e.UI=class{constructor(e){this.tabs=new Map,this.rootElement=e,this.headerElement=e.querySelector(".window-header")||n("div",["window-header"]),this.rootElement.prepend(this.headerElement),this.drawerElement=this.headerElement.querySelector(".window-drawer")||n("div",["window-drawer"]),this.headerElement.prepend(this.drawerElement),this.drawerElement.addEventListener("click",()=>{this.toggle()}),this.bodyElement=e.querySelector(".window-body")||n("div",["window-body"]),this.rootElement.append(this.bodyElement),this.bodyElement.querySelectorAll(".window-tab").forEach((e,t)=>{let i=e.getAttribute("tag");if(i){let n=e.getAttribute("label")||i;this.addTab(i,n,e).show(0==t)}})}addTab(e,i,s){let o=n("div",["window-header-tab"]);o.innerText=i,this.headerElement.appendChild(o),this.bodyElement.appendChild(s);let a=new t(e,o,s);return this.tabs.set(e,a),o.addEventListener("click",()=>{this.show(!0),this.showTab(e)}),a}removeTab(e){let t=this.tabs.get(e);if(t){t.body.remove(),t.header.remove(),this.tabs.delete(e);let i=this.tabs.keys().next().value;i&&this.showTab(i)}}showTab(e){for(let[t,i]of this.tabs)i.show(t==e)}toggle(){this.rootElement.classList.toggle("hidden")}show(e){e?this.rootElement.classList.remove("hidden"):this.rootElement.classList.add("hidden")}}}(s=t.Drawer||(t.Drawer={})),t.default=s},function(e,t,i){var n=i(0),s=i(34);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var o={insert:"head",singleton:!1};n(s,o);e.exports=s.locals||{}},function(e,t,i){(t=i(1)(!1)).push([e.i,'.window{z-index:100;position:fixed;display:flex;bottom:0;width:400px;height:500px;max-height:100%;box-sizing:border-box;transition:margin-left .5s,margin-bottom .5s;flex-direction:column;font-family:"Titillium Web","Roboto",sans-serif}.window.tall{height:800px}.window.tall.hidden{margin-bottom:calc( max( -760px, -100vh + 40px ) )}.window.left{left:50px}.window.right{right:50px}.window.right .window-header{flex-direction:row-reverse}@media screen and (max-width: 500px){.window{left:0 !important;right:0;bottom:0;height:50vh;width:100vw}}.window.hidden{margin-bottom:calc( max( -460px, -100vh + 40px ) )}@media screen and (max-width: 500px){.window.hidden{bottom:0;margin-left:0;margin-bottom:calc(-50vh + $drawer-height)}}.window>.window-header{min-height:40px;height:40px;max-height:40px;margin-left:5px;margin-right:5px;display:flex;flex-direction:row;overflow-x:auto;overflow-y:hidden;width:auto}.window>.window-header::-webkit-scrollbar{width:5px;height:5px}.window>.window-header::-webkit-scrollbar-track{background:transparent}.window>.window-header::-webkit-scrollbar-thumb{background:#aaa;border-radius:5px}.window>.window-header::-webkit-scrollbar-thumb:hover,.window>.window-header.window>.window-header.window-header-tab.active::-webkit-scrollbar-thumb,.window>.window-header.window>.window-header.active.window-drawer::-webkit-scrollbar-thumb{background:#bbb}.window>.window-header>.window-header-tab,.window>.window-header>.window-drawer{display:inline;max-height:40px;line-height:40px;background:transparent;text-align:center;padding:0px 10px 0px;color:#ccc;cursor:pointer;transition:background-color .2s,color .2s;white-space:nowrap}.window>.window-header>.window-header-tab:hover,.window>.window-header>.window-drawer:hover,.window>.window-header>.window-header-tab.active,.window>.window-header>.active.window-drawer{color:#fff}.window>.window-header>.window-header-tab.active,.window>.window-header>.active.window-drawer{font-weight:bold}.window>.window-header>.window-drawer{margin-top:0;background:none;color:#fff;min-width:40px;width:40px;padding:0}.window>.window-body{background:#bbb;height:100%;width:100%;border-radius:5px 5px 0 0;overflow:hidden;color:#000}.window>.window-body>.window-tab{height:100%;width:100%;display:none;position:relative;font-family:"Titillium Web","Roboto",sans-serif;box-sizing:border-box;overflow:auto}.window>.window-body>.window-tab.active{display:inherit}.window>.window-body>.window-tab h1{font-size:20px;margin-bottom:5px;font-weight:bold}.window>.window-body>.window-tab>.header{background:#ddd;padding:10px}.window>.window-body>.window-tab>.body{padding:10px}.window>.window-body>.window-tab>.body>.box{width:100%;padding:10px;background:#ccc;border-radius:5px;box-sizing:border-box;word-break:break-word;margin-top:10px}.window>.window-body>.window-tab>.body>.box:first-child{margin-top:0}',""]),e.exports=t}]);