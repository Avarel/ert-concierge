!function(e){var t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=11)}([function(e,t){e.exports=React},function(e,t,a){"use strict";var n,s=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},i=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),r=[];function o(e){for(var t=-1,a=0;a<r.length;a++)if(r[a].identifier===e){t=a;break}return t}function l(e,t){for(var a={},n=[],s=0;s<e.length;s++){var i=e[s],l=t.base?i[0]+t.base:i[0],d=a[l]||0,c="".concat(l," ").concat(d);a[l]=d+1;var u=o(c),h={css:i[1],media:i[2],sourceMap:i[3]};-1!==u?(r[u].references++,r[u].updater(h)):r.push({identifier:c,updater:m(h,t),references:1}),n.push(c)}return n}function d(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var s=a.nc;s&&(n.nonce=s)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var r=i(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function h(e,t,a,n){var s=a?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,s);else{var i=document.createTextNode(s),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(i,r[t]):e.appendChild(i)}}function p(e,t,a){var n=a.css,s=a.media,i=a.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),i&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var f=null,b=0;function m(e,t){var a,n,s;if(t.singleton){var i=b++;a=f||(f=d(t)),n=h.bind(null,a,i,!1),s=h.bind(null,a,i,!0)}else a=d(t),n=p.bind(null,a,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=s());var a=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<a.length;n++){var s=o(a[n]);r[s].references--}for(var i=l(e,t),d=0;d<a.length;d++){var c=o(a[d]);0===r[c].references&&(r[c].updater(),r.splice(c,1))}a=i}}}},function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a=e[1]||"",n=e[3];if(!n)return a;if(t&&"function"==typeof btoa){var s=(r=n,o=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(l," */")),i=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[a].concat(i).concat([s]).join("\n")}var r,o,l;return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,n){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(n)for(var i=0;i<this.length;i++){var r=this[i][0];null!=r&&(s[r]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);n&&s[l[0]]||(a&&(l[2]?l[2]="".concat(a," and ").concat(l[2]):l[2]=a),t.push(l))}},t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceEventHandler=t.EventHandler=void 0;class n{onReceive(e){var t,a,n,s,i,r,o;switch(e.type){case"MESSAGE":null===(t=this.onMessage)||void 0===t||t.call(this,e);break;case"HELLO":null===(a=this.onHello)||void 0===a||a.call(this,e);break;case"GROUP_FETCH_RESULT":null===(n=this.onGroupFetchResult)||void 0===n||n.call(this,e);break;case"GROUP_FETCH_ALL_RESULT":null===(s=this.onGroupFetchAllResult)||void 0===s||s.call(this,e);break;case"CLIENT_FETCH_ALL_RESULT":null===(i=this.onClientFetchAllResult)||void 0===i||i.call(this,e);break;case"SELF_FETCH_RESULT":null===(r=this.onSelfFetchResult)||void 0===r||r.call(this,e);break;case"STATUS":null===(o=this.onStatus)||void 0===o||o.call(this,e)}}}t.EventHandler=n;t.ServiceEventHandler=class extends n{constructor(e,t,a=!0){super(),this.client=e,this.group=t,this.autoSubscribe=a,this.subscribed=!1}onClose(e){this.onUnsubscribe()}onHello(e){this.client.sendJSON({type:"GROUP_FETCH",name:this.group})}onGroupFetchResult(e){e.name==this.group&&this.subscribe(this.group)}subscribe(e){this.client.sendJSON({type:"SELF_SUBSCRIBE",name:e})}onStatus(e){switch(e.code){case"NO_SUCH_GROUP":e.name==this.group&&console.warn("Group `",this.group,"` does not exist on concierge.");break;case"GROUP_DELETED":e.name==this.group&&console.warn("Group `",this.group,"` has been deleted on the concierge.");break;case"GROUP_CREATED":e.name==this.group&&this.subscribe(this.group);break;case"SELF_SUBSCRIBED":e.name==this.group&&(console.log("Subscribed to `",this.group,"`."),this.subscribed=!0,this.onSubscribe());break;case"SELF_UNSUBSCRIBED":e.name==this.group&&(console.log("Unsubscribed from `",this.group,"`."),this.subscribed=!1,this.onUnsubscribe())}}}},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Rs=void 0,a(17);const s=n(a(0));var i;!function(e){class t extends s.default.PureComponent{render(){return s.default.createElement("div",Object.assign({className:"rs-flex-row"},this.props),this.props.children)}}e.Row=t;class a extends s.default.PureComponent{render(){return s.default.createElement("div",Object.assign({className:"rs-pad"+(this.props.light?" light":"")},this.props),this.props.children)}}e.Pad=a;class n extends s.default.PureComponent{render(){return s.default.createElement("div",Object.assign({className:"rs-card"},this.props),this.props.children)}}e.Card=n;class i extends s.default.Component{constructor(e){super(e),this.state={values:e.inputs.map(e=>{})}}handleKeyDown(e,t){13===e.keyCode&&(e.preventDefault(),this.setState((e,a)=>{var n;const s=a.inputs[t].tag;if(s){const i=a.inputs[t].value,r=e.values[t];if(r&&r!=i){null===(n=a.onSubmit)||void 0===n||n.call(a,s,r);let i=e.values.slice();return i[t]=void 0,{values:i}}}return e}))}handleChange(e,t){let a=e.currentTarget.value;this.setState((e,n)=>{const s=n.inputs[t].value;a==s&&(a=void 0);let i=e.values.slice();return i[t]=a,{values:i}})}render(){return s.default.createElement("div",{className:"input-value"},s.default.createElement("div",{className:"label"},this.props.label),s.default.createElement("div",{className:"field"},this.props.inputs.map(({tag:e,value:t},a)=>s.default.createElement("input",{readOnly:null==e,value:this.state.values[a]?this.state.values[a]:t,onChange:e=>this.handleChange(e,a),onKeyDown:e=>this.handleKeyDown(e,a)}))))}}e.InputValue=i}(i=t.Rs||(t.Rs={})),t.default=i},function(e,t){e.exports=BABYLON},function(e,t){e.exports=ReactDOM},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Tabbed=t.Views=t.IconSidebar=t.Chat=void 0;const s=n(a(20));t.IconSidebar=s.default;const i=n(a(26));t.Views=i.default;const r=n(a(30));t.Chat=r.default;const o=n(a(33));t.Tabbed=o.default},,,,function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.hasOwnProperty.call(e,a)&&n(t,e,a);return s(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewer=void 0,a(12);const o=i(a(14)),l=a(15),d=a(19),c=a(37),u=a(41),h=a(43),p=a(7),f=r(a(0)),b=a(44),m=a(45);var v;!function(e){e.start=function(){const e=new URLSearchParams(window.location.search);let t=e.get("server");if(!t||0==t.length)return;let a=e.get("name");a&&0!=a.length&&function(e,t){const a=new p.Tabbed.Instance("#left-controls",500),n=new p.Tabbed.Instance("#right-controls",800,!0);n.addTab("about","About").reactContent=f.default.createElement(b.About);const s=new p.IconSidebar.Instance("#sidebar-app"),i=new p.Views.Instance("#views");let r=i.addView("main");i.render();let v=document.createElement("canvas");r.htmlElement.appendChild(v);let g=new h.Renderer,y=new o.Client(t,e,!0),E=g.createView(v);E.universalCamera();let x=new l.PhysicsHandler(y,E,n);y.handlers.push(x);let w=new c.PlanetsHandler(y,E,n);y.handlers.push(w);let S=new d.ChatHandler(y,a);y.handlers.push(S);let _=new u.UsersHandler(y,s,a);y.handlers.push(_);let C=new m.GroupsHandler(y,a);y.handlers.push(C),g.start(),y.connect("0.1.1")}(t,a)}}(v=t.Viewer||(t.Viewer={})),v.start()},function(e,t,a){var n=a(1),s=a(13);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var i={insert:"head",singleton:!1};n(s,i);e.exports=s.locals||{}},function(e,t,a){(t=a(2)(!1)).push([e.i,'body{height:100vh;width:100vw}.app{height:100%;width:100%;overflow:hidden}.app canvas{width:100%;height:100%;touch-action:none}.app #views{width:100%;height:100%}.float-window{z-index:100;position:fixed;display:flex;bottom:0;width:400px;max-height:100%;box-sizing:border-box;transition:margin-left .5s,margin-bottom .5s;flex-direction:column;font-family:"Titillium Web","Roboto",sans-serif}.float-window.left{left:50px}.float-window.right{right:50px}@media screen and (max-width: 500px){.float-window{left:0 !important;right:0;bottom:0;max-height:50vh;width:100vw}}',""]),e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;class n{constructor(e,t,a=!1){this.name=e,this.url=t,this.reconnect=a,this.seq=-1,this.reconnectInterval=1e4,this.handlers=[]}connect(e,t){console.info("Trying to connect to ",this.url),this.version=e,this.secret=t,this.socket=new WebSocket(this.url,"ert-concierge"),this.socket.onopen=e=>this.onOpen(e),this.socket.onmessage=e=>this.onReceive(e),this.socket.onerror=e=>this.onError(e),this.socket.onclose=e=>this.onClose(e)}sendJSON(e){if(null==this.socket)throw new Error("Socket is not connected");this.socket.send(JSON.stringify(e));let t=this.seq;return this.seq+=1,t}close(e,t,a=!0){if(null==this.socket)throw new Error("Socket is not connected");this.socket.close(e,t),a?this.tryReconnect():(this.socket=void 0,this.version=void 0,this.secret=void 0)}tryReconnect(){this.reconnect&&(console.warn("Connection closed, reconnecting in",this.reconnectInterval,"ms"),setTimeout(()=>{this.connect(this.version,this.secret)},this.reconnectInterval))}onOpen(e){var t;for(let a of this.handlers)null===(t=a.onOpen)||void 0===t||t.call(a,e);if(null==this.version)throw new Error("Version is undefined");console.log("Identifying with version",this.version),this.sendJSON({type:"IDENTIFY",name:this.name,version:this.version,secret:this.secret,tags:["babylon"]})}onClose(e){var t;for(let a of this.handlers)null===(t=a.onClose)||void 0===t||t.call(a,e);console.warn(e.code,e.reason),this.tryReconnect()}onReceive(e){var t;let a=JSON.parse(e.data);if(a.hasOwnProperty("type")){let e=a;"HELLO"==e.type&&(console.log("Assigned uuid",e.uuid),this.uuid=e.uuid,this.seq=0);for(let a of this.handlers)null===(t=a.onReceive)||void 0===t||t.call(a,e)}}onError(e){var t;for(let a of this.handlers)null===(t=a.onError)||void 0===t||t.call(a,e);console.log(e)}}t.Client=n,t.default=n},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PhysicsHandler=t.PHYSICS_ENGINE_GROUP=t.PHYSICS_ENGINE_NAME=void 0;const s=a(5),i=a(3),r=a(16),o=n(a(0));function l(e){return new s.Vector2(e.x-500,e.y-500)}function d(e){function t(e){return Math.max(0,Math.min(e,255))/255}return new s.Color3(t(e[0]),t(e[1]),t(e[2]))}t.PHYSICS_ENGINE_NAME="physics_engine",t.PHYSICS_ENGINE_GROUP="physics_engine_out";class c{constructor(e,t){this.centroid=e,this.mesh=t}static createPolygon(e,t,a,n,i=1){let r=t.map(e=>e.scaleInPlace(i)),o=new s.PolygonMeshBuilder("polytri",r,a).build(void 0,50*i);o.position.y+=50*i;var l=new s.StandardMaterial("myMaterial",a);return l.diffuseColor=n,o.material=l,o.actionManager=new s.ActionManager(a),new c(e.scaleInPlace(i),o)}setColor(e){this.mesh.material.diffuseColor=e}moveTo(e){let t=e.subtract(this.centroid);this.mesh.position.addInPlace(t),this.centroid.set(e.x,e.y,e.z)}dispose(){this.mesh.dispose()}}class u extends i.ServiceEventHandler{constructor(e,a,n){super(e,t.PHYSICS_ENGINE_GROUP),this.renderer=a,this.tabbedComponent=n,this.shapes=new Map,this.visualScale=.02}sendToSim(e){this.client.sendJSON({type:"MESSAGE",target:{type:"NAME",name:t.PHYSICS_ENGINE_NAME},data:e})}onMessage(e){e.origin.name==t.PHYSICS_ENGINE_NAME&&this.processPhysicsPayload(e.data)}onSubscribe(){var e;console.log("Fetching..."),this.sendToSim({type:"FETCH_ENTITIES"}),this.sendToSim({type:"SPAWN_ENTITY"}),this.tab=null===(e=this.tabbedComponent)||void 0===e?void 0:e.addTab(t.PHYSICS_ENGINE_NAME,"Rust Physics"),this.renderController()}renderController(){this.tab&&(this.tab.reactContent=o.default.createElement(r.PhysicsComponent,{handler:this}))}onUnsubscribe(){this.clearShapes(),this.destroyController()}destroyController(){var e;null===(e=this.tabbedComponent)||void 0===e||e.removeTab(t.PHYSICS_ENGINE_NAME)}clearShapes(){for(let e of this.shapes.keys())if(this.shapes.has(e)){this.shapes.get(e).dispose(),this.shapes.delete(e)}}createPolygon(e,t,a,n){if(this.renderer.scene){let i=c.createPolygon(new s.Vector3(t.x,0,t.y),a,this.renderer.scene,n,this.visualScale);return this.shapes.set(e,i),i}throw new Error("Scene not initialized!")}createShape(e,t,a,n){let i=l(t),r=a.map(l),o=d(n);this.createPolygon(e,i,r,o).mesh.actionManager.registerAction(new s.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,()=>{console.log("Clicking on object ",e,"."),this.sendToSim({type:"TOUCH_ENTITY",id:e})}))}removeShape(e){let t=this.shapes.get(e);t&&(t.dispose(),this.shapes.delete(e))}updateShape(e,t){let a=this.shapes.get(e);if(a){let e=l(t);a.moveTo(new s.Vector3(e.x,0,e.y).scaleInPlace(this.visualScale))}}updateColor(e,t){let a=this.shapes.get(e);a&&a.setColor(d(t))}processPhysicsPayload(e){switch(e.type){case"ENTITY_NEW":let t=e.entity;this.createShape(t.id,t.centroid,t.points,t.color);break;case"ENTITY_DELETE":for(let t of e.ids)this.removeShape(t);break;case"ENTITY_DUMP":console.log("Dumping entities!"),this.clearShapes();for(let t of e.entities)this.createShape(t.id,t.centroid,t.points,t.color);break;case"POSITION_DUMP":for(let t of e.updates)this.updateShape(t.id,t.position);break;case"COLOR_UPDATE":this.updateColor(e.id,e.color)}}}t.PhysicsHandler=u},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PhysicsComponent=void 0;const s=n(a(0)),i=n(a(4));class r extends s.default.Component{handleRespawn(){this.props.handler.sendToSim({type:"SPAWN_ENTITY"})}render(){return s.default.createElement("div",{className:"rstyled full"},s.default.createElement(i.default.Pad,{light:!0},s.default.createElement("h1",null,"Rust Physics"),s.default.createElement("p",null,"Hypercasual Game"),s.default.createElement("button",{onClick:()=>this.handleRespawn()},"Respawn")),s.default.createElement(i.default.Pad,{style:{flexGrow:1}},s.default.createElement(i.default.Card,null,s.default.createElement("h2",null,"Instructions"),s.default.createElement("p",null,"Click on your own box colors to duplicate it."),s.default.createElement("p",null,"Click on boxes with another color to destroy them.")),s.default.createElement(i.default.Card,null,s.default.createElement("p",null,"Simulation written in Rust with Specs + Serde."))),s.default.createElement(i.default.Pad,{light:!0},s.default.createElement("p",null,"SURF 2020 / OVRAS")))}}t.PhysicsComponent=r},function(e,t,a){var n=a(1),s=a(18);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var i={insert:"head",singleton:!1};n(s,i);e.exports=s.locals||{}},function(e,t,a){(t=a(2)(!1)).push([e.i,'.rstyled{background-color:rgba(180,180,180,.95);position:relative;font-family:"Titillium Web","Roboto",sans-serif;box-sizing:border-box;overflow:auto;display:flex;flex-direction:column}.rstyled.full{width:100%;height:100%}.rstyled h1{font-size:30px;margin-bottom:5px;font-weight:bold}.rstyled h2{font-size:20px;margin-bottom:5px;font-weight:bold}.rstyled p{margin-bottom:5px}.rstyled p:last-child{margin-bottom:0}.rstyled button{flex:1 0 0;font-family:inherit;font-size:15px;margin:5px;padding:10px;border:none;border-radius:5px;transition:transform .2s;background:#fff;color:#000}.rstyled button.red{background:#df0000;color:#fff}.rstyled button.orange{background:#ff6c0c;color:#fff}.rstyled button.yellow{background:#cac700;color:#fff}.rstyled button.green{background:#00b199;color:#fff}.rstyled button.blue{background:#0c4dff;color:#fff}.rstyled button.purple{background:#9800df;color:#fff}.rstyled button:focus{outline:none}.rstyled button:hover{opacity:.7;transform:scale(1.05)}.rstyled button:active{opacity:.3;transform:scale(0.95)}.rstyled .input-value{display:flex;margin-bottom:5px}.rstyled .input-value>.label{width:40%;text-align:right;padding-right:10px;box-sizing:border-box;align-self:center}.rstyled .input-value>.field{flex:1 0 auto;display:flex;flex-direction:column}.rstyled .input-value>.field input{font-family:inherit;width:100%;padding:5px;box-sizing:border-box;border:none;background:rgba(255,255,255,.8);text-align:right;transition:background-color .2s}.rstyled .input-value>.field input:read-only{background:rgba(255,255,255,.4);outline:none}.rstyled .input-value>.field input:first-child{border-radius:5px 5px 0 0}.rstyled .input-value>.field input:not(:first-child):not(:last-child){border-radius:0}.rstyled .input-value>.field input:not(:last-child){margin-bottom:1px}.rstyled .input-value>.field input:last-child{border-radius:0 0 5px 5px}.rstyled .input-value>.field input:first-child:last-child{border-radius:5px}.rstyled .rs-pad{display:flex;padding:10px;flex-direction:column}.rstyled .rs-pad.light{background:rgba(255,255,255,.4)}.rstyled .rs-pad .rs-card{display:flex;flex-direction:column;width:100%;padding:10px;border-radius:5px;box-sizing:border-box;word-break:break-word;margin-bottom:10px;background:rgba(255,255,255,.25)}.rstyled .rs-pad .rs-card:last-child{margin-bottom:0}.rstyled .rs-flex-row{display:flex;flex-direction:row}',""]),e.exports=t},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChatHandler=void 0;const s=a(3),i=n(a(0)),r=a(7);class o extends s.ServiceEventHandler{constructor(e,t){super(e,"chat"),this.tabComponent=t,this.items=[],this.tab=this.tabComponent.addTab("chat","Chat"),this.onEnter=this.onEnter.bind(this),this.render()}onSubscribe(){this.addStatus("Connected to the chat system.")}onEnter(e){this.client.sendJSON({type:"MESSAGE",target:{type:"GROUP",group:"chat"},data:e})}render(){this.tab.reactContent=i.default.createElement(r.Chat.Component,{items:this.items,onSubmit:this.onEnter})}addStatus(e){this.items.push({type:"STATUS",text:e}),this.render()}addMessage(e,t,a=!1){this.items.push({type:"MESSAGE",name:e,text:t,you:a}),this.render()}onMessage(e){var t;e.origin&&"chat"==(null===(t=e.origin.group)||void 0===t?void 0:t.name)&&"string"==typeof e.data&&this.addMessage(e.origin.name,e.data,e.origin.name==this.client.name)}onUnsubscribe(){this.addStatus("Disconnected from the chat system.")}}t.ChatHandler=o},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.IconSidebar=void 0;const s=n(a(21)),i=n(a(6)),r=n(a(0));var o;!function(e){class t{constructor(e,a,n){this.id=e,this.label=a,this.imgSrc=n,this.colorCss=t.makeHSLColor(this.label)}static hashString(e){var t,a=0;for(t=0;t<e.length;t++)a=(a<<5)-a+e.charCodeAt(t),a|=0;return a}static makeHSLColor(e){return`hsl(${t.hashString(e)%360}, 100%, 25%)`}toProps(){return{id:this.id,label:this.label,colorCss:this.colorCss,imgSrc:this.imgSrc}}}e.Icon=t;e.Instance=class{constructor(e){if(this.iconsMap=new Map,"string"==typeof e){const t=document.querySelector(e);if(!t)throw new Error("Can not insantiate Tabbed on an undefined element.");this.element=t}else this.element=e}addIcon(e,a,n){const s=new t(e,a,n);return this.iconsMap.set(e,s),this.render(),s}clear(){this.iconsMap.clear(),this.render()}getIcon(e){return this.iconsMap.get(e)}removeIcon(e){const t=this.iconsMap.delete(e);return this.render(),t}render(){this.component=i.default.render(r.default.createElement(s.default.Component,{icons:Array.from(this.iconsMap.values(),e=>e.toProps())}),this.element)}}}(o=t.IconSidebar||(t.IconSidebar={})),t.default=o},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.IconSidebarReact=void 0,a(22);const s=n(a(0));var i;a(24),function(e){class t extends s.default.PureComponent{constructor(e){super(e),this.state={items:e.icons||new Map}}icon(e){return e.imgSrc?s.default.createElement("div",{className:"icon"},s.default.createElement("img",{src:e.imgSrc})):s.default.createElement("div",{className:"icon"},s.default.createElement("p",{style:{backgroundColor:e.colorCss}},e.label.charAt(0)))}render(){return s.default.createElement("div",{className:"sidebar"},Array.from(this.props.icons.values(),e=>s.default.createElement(this.icon,Object.assign({},e))))}}e.Component=t}(i=t.IconSidebarReact||(t.IconSidebarReact={})),t.default=i},function(e,t,a){var n=a(1),s=a(23);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var i={insert:"head",singleton:!1};n(s,i);e.exports=s.locals||{}},function(e,t,a){(t=a(2)(!1)).push([e.i,'.sidebar{position:fixed;z-index:100;top:0;left:0;flex-direction:column;display:flex;overflow:auto;width:70px;height:100%;padding:15px;pointer-events:none}.sidebar.horizontal{height:70px;width:100%;flex-direction:row}.sidebar::-webkit-scrollbar{width:5px}.sidebar::-webkit-scrollbar-track{background:transparent}.sidebar::-webkit-scrollbar-thumb{background:#444;border-radius:5px}.sidebar::-webkit-scrollbar-thumb:hover{background:#555}.sidebar .icon{pointer-events:all;flex:0 0 auto;width:70px;height:70px;margin:0px 10px 10px 0;box-sizing:border-box;position:relative}.sidebar .icon img,.sidebar .icon p{height:100%;width:100%;background:#000;border-radius:50%;cursor:pointer;transition:border-radius .2s}.sidebar .icon img:hover,.sidebar .icon p:hover{border-radius:10px}.sidebar .icon p{color:#fff;line-height:70px;text-align:center;font-size:40px;font-family:"Titillium Web","Roboto",sans-serif;user-select:none}.tippy-box{font-family:"Titillium Web","Roboto",sans-serif !important}',""]),e.exports=t},function(e,t,a){var n=a(1),s=a(25);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var i={insert:"head",singleton:!1};n(s,i);e.exports=s.locals||{}},function(e,t,a){(t=a(2)(!1)).push([e.i,'.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}',""]),e.exports=t},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Views=t.createElement=void 0,a(27);const s=n(a(0)),i=a(29),r=n(a(6));var o;t.createElement=function(e,t=[]){let a=document.createElement(e);return a.classList.add(...t),a},function(e){class t{constructor(e,t){this.instance=e,this.id=t,this.jsxContent=null,this.ref=s.default.createRef()}get htmlElement(){return this.jsxContent=void 0,this.ref.current}set reactContent(e){this.jsxContent=e,this.instance.render()}toProps(){return console.log("refz",this.ref),{id:this.id,jsxContent:this.jsxContent,refobj:this.ref}}}e.View=t;e.Instance=class{constructor(e,t=!1){if(this.enableSplit=t,this.viewsMap=new Map,null==e)throw new Error("Root element must not be null!");if("string"==typeof e){let t=document.querySelector(e);if(!t)throw new Error("Query selector "+e+" return null!");this.element=t}else this.element=e}addView(e){let a=new t(this,e);return this.viewsMap.set(e,a),this.render(),a}removeView(e){this.viewsMap.delete(e),this.render()}render(){this.component=r.default.render(s.default.createElement(i.ViewsReact.Component,{views:Array.from(this.viewsMap.values(),e=>e.toProps())}),this.element)}}}(o=t.Views||(t.Views={})),t.default=o},function(e,t,a){var n=a(1),s=a(28);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var i={insert:"head",singleton:!1};n(s,i);e.exports=s.locals||{}},function(e,t,a){(t=a(2)(!1)).push([e.i,".views{width:100%;height:100%;display:flex}.views .view{flex:1 0 0;height:100%}.gutter.gutter-horizontal{cursor:ew-resize;background-color:#000;height:100vh}",""]),e.exports=t},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewsReact=void 0;const s=n(a(0));!function(e){class t extends s.default.Component{view(e){return s.default.createElement("div",{className:"view",ref:e.refobj},e.jsxContent)}render(){return s.default.createElement("div",{className:"views"},Array.from(this.props.views,e=>s.default.createElement(this.view,Object.assign({},e))))}}e.Component=t}(t.ViewsReact||(t.ViewsReact={}))},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Chat=void 0,a(31);const s=n(a(0));var i;!function(e){class t extends s.default.Component{constructor(e){super(e),this.messagesEndRef=s.default.createRef()}componentDidUpdate(){const e=this.messagesEndRef.current;e&&(e.scrollTop=e.scrollHeight)}set onSubmit(e){this.setState({onSubmit:e})}render(){return s.default.createElement("div",{className:"chat-container"},s.default.createElement("div",{className:"chat-messages",ref:this.messagesEndRef},this.props.items.map(e=>s.default.createElement(a,Object.assign({},e)))),s.default.createElement(n,{onSubmit:this.props.onSubmit}))}}e.Component=t;class a extends s.default.PureComponent{render(){return"MESSAGE"==this.props.type?s.default.createElement("div",{className:"chat-item"+(this.props.you?" you":"")},s.default.createElement("div",{className:"name"},this.props.name),s.default.createElement("div",{className:"text"},this.props.text)):s.default.createElement("div",{className:"chat-item status"},s.default.createElement("div",{className:"text"},this.props.text))}}class n extends s.default.PureComponent{constructor(e){super(e),this.state={text:""}}handleChange(e){this.setState({text:e.target.value})}handleKeyDown(e){13===e.keyCode&&(e.preventDefault(),this.handleSubmit())}handleSubmit(){this.setState((e,t)=>{var a;return e.text&&(null===(a=t.onSubmit)||void 0===a||a.call(t,e.text)),{text:""}})}render(){return s.default.createElement("div",{className:"chat-input"},s.default.createElement("input",{className:"chat-input-field",type:"text",placeholder:"Text message...",value:this.state.text,onChange:e=>this.handleChange(e),onKeyDown:e=>this.handleKeyDown(e)}),s.default.createElement("button",{className:"chat-submit-btn",onClick:()=>this.handleSubmit()},s.default.createElement("i",{className:"fa fa-paper-plane"})))}}}(i=t.Chat||(t.Chat={})),t.default=i},function(e,t,a){var n=a(1),s=a(32);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var i={insert:"head",singleton:!1};n(s,i);e.exports=s.locals||{}},function(e,t,a){(t=a(2)(!1)).push([e.i,'.chat-container{background:rgba(204,204,204,.95);color:#000;height:100%;width:100%;display:flex;flex-direction:column;font-family:"Titillium Web","Roboto",sans-serif}.chat-container .chat-input{position:absolute;display:flex;width:100%;height:0px;bottom:50px;background:#aaa;padding-left:10px;padding-right:10px;box-sizing:border-box}.chat-container .chat-input input.chat-input-field{background:#aaa;border:0;padding:5px;box-sizing:border-box;height:40px;width:100%;border-radius:5px;margin-right:5px;outline:none;font-family:"Titillium Web","Roboto",sans-serif}.chat-container .chat-input button.chat-submit-btn{line-height:40px;text-align:center;line-height:40px;height:40px;width:40px;box-sizing:border-box;border-radius:5px;background:#fff;user-select:none;cursor:pointer;border:none}.chat-container .chat-input button.chat-submit-btn:hover{background:#eee}.chat-container .chat-messages{padding:15px;height:100%;width:100%;box-sizing:border-box;display:flex;flex-direction:column;position:relative;overflow:auto}.chat-container .chat-messages::-webkit-scrollbar{width:10px}.chat-container .chat-messages::-webkit-scrollbar-track{background:transparent}.chat-container .chat-messages::-webkit-scrollbar-thumb{background:#aaa;border-radius:5px}.chat-container .chat-messages::-webkit-scrollbar-thumb:hover{background:#bbb}.chat-container .chat-messages .chat-item{display:flex;max-width:90%;flex-direction:column;align-self:flex-start}.chat-container .chat-messages .chat-item:last-child{margin-bottom:40px}.chat-container .chat-messages .chat-item.you{align-self:flex-end}.chat-container .chat-messages .chat-item.you .name{text-align:right}.chat-container .chat-messages .chat-item.you .text{border-radius:5px 0px 5px 5px;align-self:flex-end}.chat-container .chat-messages .chat-item.status{width:100%;max-width:100%}.chat-container .chat-messages .chat-item.status .text{text-align:center;background:none;margin:0;padding:0;color:#888}.chat-container .chat-messages .chat-item .name{text-align:left;margin:10px 10px 0px}.chat-container .chat-messages .chat-item .text{border-radius:0 5px 5px;background:#fff;padding:10px;word-break:break-all;margin:5px}',""]),e.exports=t},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Tabbed=void 0,a(34);const s=n(a(0)),i=n(a(36)),r=n(a(6));var o;!function(e){class t{constructor(e,t,a){this.instance=e,this.id=t,this.label=a,this.jsxContent=null,this.ref=s.default.createRef()}get isActive(){var e;return(null===(e=this.instance.component)||void 0===e?void 0:e.activeId)==this.id}get htmlElement(){return this.jsxContent=void 0,this.ref.current}set reactContent(e){this.jsxContent=e,this.instance.render()}toProps(){return{jsxContent:this.jsxContent,id:this.id,label:this.label,refobj:this.ref}}}e.Tab=t;e.Instance=class{constructor(e,t,a=!1,n=!1){if(this.contentHeight=t,this.reverseHeader=a,this.initShow=n,this.tabsMap=new Map,"string"==typeof e){const t=document.querySelector(e);if(!t)throw new Error("Can not insantiate Tabbed on an undefined element.");this.element=t}else this.element=e}get tabs(){return this.tabsMap}addTab(e,a){const n=new t(this,e,a);return this.tabsMap.set(e,n),this.render(),n}getTab(e){return this.tabsMap.get(e)}removeTab(e){var t;const a=this.tabsMap.delete(e);return(null===(t=this.component)||void 0===t?void 0:t.activeId)==e&&(this.component.activeId=void 0),this.render(),a}render(){this.component=r.default.render(s.default.createElement(i.default.Component,{tabs:Array.from(this.tabsMap.values(),e=>e.toProps()),contentHeight:this.contentHeight,reverseHeader:this.reverseHeader,initShow:this.initShow}),this.element)}}}(o=t.Tabbed||(t.Tabbed={})),t.default=o},function(e,t,a){var n=a(1),s=a(35);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var i={insert:"head",singleton:!1};n(s,i);e.exports=s.locals||{}},function(e,t,a){(t=a(2)(!1)).push([e.i,".tabbed{height:auto;width:100%;display:flex;flex-direction:column}.tabbed.hidden>.tabbed-content{display:none}.tabbed.hidden>.tabbed-header>.tabbed-drawer{transform:rotate(180deg)}.tabbed>.tabbed-header{margin-left:5px;margin-right:5px;flex:0 0 40px;display:flex;flex-direction:row;overflow-x:auto;overflow-y:hidden;width:auto;text-shadow:0px 0px 10px rgba(0,0,0,.5)}.tabbed>.tabbed-header::-webkit-scrollbar{width:5px;height:5px}.tabbed>.tabbed-header::-webkit-scrollbar-track{background:transparent}.tabbed>.tabbed-header::-webkit-scrollbar-thumb{background:#666;border-radius:5px}.tabbed>.tabbed-header::-webkit-scrollbar-thumb:hover,.tabbed>.tabbed-header.tabbed>.tabbed-header.tabbed-header-label.active::-webkit-scrollbar-thumb,.tabbed>.tabbed-header.tabbed>.tabbed-header.tabbed-drawer::-webkit-scrollbar-thumb{background:#777}.tabbed>.tabbed-header::-webkit-scrollbar-thumb:active{background:#888}.tabbed>.tabbed-header>.tabbed-header-label,.tabbed>.tabbed-header>.tabbed-drawer{display:inline;line-height:40px;background:transparent;text-align:center;padding:0px 10px 0px;color:#ccc;cursor:pointer;transition:color .2s;white-space:nowrap}.tabbed>.tabbed-header>.tabbed-header-label:hover,.tabbed>.tabbed-header>.tabbed-drawer:hover,.tabbed>.tabbed-header>.tabbed-header-label.active,.tabbed>.tabbed-header>.tabbed-header-label.tabbed-drawer,.tabbed>.tabbed-header>.active.tabbed-drawer,.tabbed>.tabbed-header>.tabbed-drawer{color:#fff}.tabbed>.tabbed-header>.tabbed-header-label.active,.tabbed>.tabbed-header>.tabbed-header-label.tabbed-drawer,.tabbed>.tabbed-header>.active.tabbed-drawer,.tabbed>.tabbed-header>.tabbed-drawer{font-weight:bold}.tabbed>.tabbed-header>.tabbed-drawer{min-width:40px;width:40px;padding:0;transition:transform .5s}.tabbed>.tabbed-content{background:#bbb;width:100%;border-radius:5px 5px 0 0;overflow:hidden;color:#000;display:flex;position:relative;box-shadow:0px 0px 10px rgba(0,0,0,.25)}.tabbed>.tabbed-content>.tabbed-body{height:100%;width:100%;display:none}.tabbed>.tabbed-content>.tabbed-body.active,.tabbed>.tabbed-header.tabbed-content>.tabbed-body.tabbed-drawer{display:inherit}",""]),e.exports=t},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TabbedReact=void 0;const s=n(a(0));var i;!function(e){let t;!function(e){e.header=function(e){return s.default.createElement("div",{className:"tabbed-header-label"+(e.component.isActive(e.id)?" active":""),onClick:()=>e.component.makeActive(e.id)},e.label)},e.body=function(e){return e.jsxContent||null===e.jsxContent?e.component.isActive(e.id)?s.default.createElement("div",{className:"tabbed-body"+(e.component.isActive(e.id)?" active":""),ref:e.refobj},e.jsxContent):null:s.default.createElement("div",{className:"tabbed-body"+(e.component.isActive(e.id)?" active":""),ref:e.refobj})}}(t||(t={}));class a extends s.default.Component{constructor(e){var t;super(e),this.state={shown:e.initShow||!1,activeId:null===(t=e.tabs[0])||void 0===t?void 0:t.id}}get isShown(){return this.state.shown&&this.state.activeId}isActive(e){return this.state.shown&&this.state.activeId==e}toggleShown(e=!this.state.shown){this.setState({shown:e})}makeActive(e){this.toggleShown(!0),this.activeId=e}get activeId(){return this.state.activeId}set activeId(e){this.setState({activeId:e})}render(){return s.default.createElement("div",{className:"tabbed"+(this.isShown?"":" hidden")},s.default.createElement("div",{className:"tabbed-header",style:this.props.reverseHeader?{flexDirection:"row-reverse"}:{}},s.default.createElement("div",{className:"tabbed-drawer",onClick:()=>this.toggleShown()},s.default.createElement("i",{className:"fa fa-angle-double-down"})),Array.from(this.props.tabs,e=>s.default.createElement(t.header,Object.assign({component:this},e)))),s.default.createElement("div",{className:"tabbed-content",style:{height:this.props.contentHeight}},Array.from(this.props.tabs,e=>s.default.createElement(t.body,Object.assign({component:this},e)))))}}e.Component=a}(i=t.TabbedReact||(t.TabbedReact={})),t.default=i},function(e,t,a){"use strict";var n=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))((function(s,i){function r(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PlanetsHandler=t.PLANET_SIM_GROUP=t.PLANET_SIM_NAME=void 0,a(38);const i=a(5),r=a(3),o=s(a(0)),l=a(40);t.PLANET_SIM_NAME="planetary_simulation",t.PLANET_SIM_GROUP="planetary_simulation_out";class d{constructor(e,t,a,n){this.id=e,this.centroid=t,this.mesh=a,this.trailMesh=n}static create(e,t,a,n,s,r=1){let o=i.MeshBuilder.CreateSphere("mySphere",{diameter:2*a*r},n);o.position=t;var l=new i.StandardMaterial("myMaterial",n);l.diffuseColor=s,o.material=l,o.actionManager=new i.ActionManager(n);let c=new i.TrailMesh("trail",o,n,Math.min(.02,a*r),1e3,!0);return new d(e,t,o,c)}dispose(){var e;this.unhookHover(),null===(e=this.trailMesh)||void 0===e||e.dispose(),this.mesh.dispose()}hookHover(e){this.mesh.actionManager&&(this.enterAction=new i.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOverTrigger,()=>{e.hoveredPlanets.add(this.id),e.renderInformation()}),this.exitAction=new i.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOutTrigger,()=>{e.hoveredPlanets.delete(this.id),e.renderInformation()}),this.clickAction=new i.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,()=>{e.planetLock==this.id?e.planetLock=void 0:e.planetLock=this.id,e.renderInformation()}),this.mesh.actionManager.registerAction(this.enterAction),this.mesh.actionManager.registerAction(this.exitAction),this.mesh.actionManager.registerAction(this.clickAction))}unlit(){this.mesh.material.emissiveColor=i.Color3.Black()}lit(){this.mesh.material.emissiveColor=i.Color3.Red()}unhookHover(){this.mesh.actionManager&&(this.enterAction&&(this.mesh.actionManager.unregisterAction(this.enterAction),this.enterAction=void 0),this.exitAction&&(this.mesh.actionManager.unregisterAction(this.exitAction),this.exitAction=void 0),this.clickAction&&(this.mesh.actionManager.unregisterAction(this.clickAction),this.clickAction=void 0))}setColor(e){this.mesh.material.diffuseColor=e}moveTo(e){let t=e.subtract(this.centroid);this.mesh.position.addInPlace(t),this.centroid.set(e.x,e.y,e.z)}}class c extends r.ServiceEventHandler{constructor(e,a,n){super(e,t.PLANET_SIM_GROUP),this.view=a,this.tabbedComponent=n,this.visualScale=5,this.hoveredPlanets=new Set,this.planets=new Map}onMessage(e){e.origin.name==t.PLANET_SIM_NAME&&this.processPlanetsPayload(e.data)}sendToSim(e){this.client.sendJSON({type:"MESSAGE",target:{type:"NAME",name:t.PLANET_SIM_NAME},data:e})}onSubscribe(){var e;this.tab=null===(e=this.tabbedComponent)||void 0===e?void 0:e.addTab(t.PLANET_SIM_NAME,"Planetary Controls"),console.log("Planet simulator client is ready to go!"),this.sendToSim({type:"FETCH_SYSTEM_DATA"})}renderInformation(e=!1){if(this.planetLock||0!=this.hoveredPlanets.size){let e;if(e=this.planetLock?this.planets.get(this.planetLock):this.planets.get(this.hoveredPlanets.values().next().value),e&&e.id!=this.litPlanet){if(this.litPlanet){let e=this.planets.get(this.litPlanet);null==e||e.unlit()}e.lit(),this.litPlanet=e.id}}else{for(const e of this.planets.values())e.unlit();this.litPlanet=void 0}this.tab&&(this.tab.isActive||e)&&(this.tab.reactContent=o.default.createElement(l.PlanetaryComponent,{handler:this}))}upload(e,t){return n(this,void 0,void 0,(function*(){const a=new URL(`/fs/${this.client.name}/system.json`,e),n=new Headers;n.append("x-fs-key",this.client.uuid);const s=yield fetch(a.toString(),{method:"POST",headers:n,body:t});switch(s.status){case 200:case 201:this.sendToSim({type:"LOAD_SYSTEM",url:a.toString()});break;default:alert("Unexpected response:"+s.status+" "+s.statusText)}}))}onUnsubscribe(){var e;null===(e=this.tabbedComponent)||void 0===e||e.removeTab(t.PLANET_SIM_NAME),this.clearShapes(),console.log("Planet simulator client has disconnected!")}clearShapes(){for(let e of this.planets.keys()){const t=this.planets.get(e);t&&(t.dispose(),this.planets.delete(e))}}processPlanetsPayload(e){switch(e.type){case"SYSTEM_REMOVE_PLANETS":for(const t of e.ids){let e=this.planets.get(t);e&&(e.dispose(),this.planets.delete(t))}this.renderInformation();break;case"SYSTEM_DATA_DUMP":this.sysData=e.data,this.clearShapes(),this.sendToSim({type:"FETCH_SYSTEM_OBJS"}),this.renderInformation(!0);break;case"SYSTEM_OBJS_DUMP":if(null==this.sysData)return;for(let t of e.objects){let e=new i.Vector3(t.location[0],t.location[1],t.location[2]).scaleInPlace(1/this.sysData.scale).scaleInPlace(this.visualScale);if(this.planets.has(t.name)){let a=this.planets.get(t.name);a.moveTo(e),a.data=t}else{if(!this.view.scene)throw new Error("Scene not initialized!");{let a=t.radius/this.sysData.scale*this.sysData.bodyScale*this.visualScale,n=i.Color3.FromArray(t.color);t.name==this.sysData.centralBodyName&&(console.log("Found central body!"),a*=this.sysData.centralBodyScale,e.scaleInPlace(this.sysData.centralBodyScale));let s=d.create(t.name,e,a,this.view.scene,n);s.hookHover(this),s.data=t,this.planets.set(t.name,s)}}}this.renderInformation();break;case"SYSTEM_CLEAR":console.log("Clearing shapes"),this.renderInformation(),this.clearShapes()}}}t.PlanetsHandler=c},function(e,t,a){var n=a(1),s=a(39);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var i={insert:"head",singleton:!1};n(s,i);e.exports=s.locals||{}},function(e,t,a){(t=a(2)(!1)).push([e.i,".planetary-controls .planetary-upload{display:flex}.planetary-controls .planetary-upload input[type=file]{flex:1 0 0;align-self:center}.planetary-controls #icons{justify-content:space-evenly}.planetary-controls #icons i{font-size:30px;opacity:.5;transition:transform .2s;cursor:pointer}.planetary-controls #icons i:hover{transform:scale(1.2)}",""]),e.exports=t},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PlanetaryComponent=void 0;const s=n(a(4)),i=n(a(0));class r extends i.default.Component{constructor(e){super(e),this.state={fps:0,fdelta:0,pmeshes:0}}componentDidMount(){this.loop=window.setInterval(()=>{this.setState(()=>({fps:this.props.handler.view.renderer.engine.getFps().toFixed(2),fdelta:this.props.handler.view.renderer.engine.getDeltaTime().toFixed(2),pmeshes:this.props.handler.planets.size}))},1e3)}componentWillUnmount(){window.clearInterval(this.loop)}render(){this.props.handler;return i.default.createElement(s.default.Card,null,i.default.createElement("h2",null,"Rendering Statistics"),i.default.createElement(s.default.InputValue,{label:"FPS",inputs:[{value:this.state.fps}]}),i.default.createElement(s.default.InputValue,{label:"Frame Delta",inputs:[{value:this.state.fdelta+"ms"}]}),i.default.createElement(s.default.InputValue,{label:"Planet Meshes",inputs:[{value:this.state.pmeshes}]}))}}class o extends i.default.Component{render(){return i.default.createElement("div",{className:"planetary-controls rstyled full"},i.default.createElement(s.default.Pad,{light:!0},i.default.createElement(c,{handler:this.props.handler}),i.default.createElement(l,{handler:this.props.handler})),i.default.createElement(s.default.Pad,null,i.default.createElement(d,{handler:this.props.handler}),i.default.createElement(r,{handler:this.props.handler}),i.default.createElement(s.default.Card,null,i.default.createElement("h2",null,"Planetary Simulation"),i.default.createElement("p",null,"Python Simulation by Alison Noyes"),i.default.createElement("p",null,"BabylonJS Front-end by An Tran"))))}}t.PlanetaryComponent=o;class l extends i.default.Component{handleFieldUpdate(e,t,a){this.props.handler.sendToSim({type:"UPDATE_DATA",target:e,field:t,value:a})}conditional(){let e=this.props.handler;if(e.planetLock){let t=e.planets.get(e.planetLock);return t?i.default.createElement(h,{data:t.data,onSubmit:(e,a)=>this.handleFieldUpdate(t.id,e,a)}):null}if(0!=e.hoveredPlanets.size){let t=e.hoveredPlanets.values().next(),a=e.planets.get(t.value);return a?i.default.createElement(h,{data:a.data,onSubmit:(e,t)=>this.handleFieldUpdate(a.id,e,t)}):null}return e.sysData?i.default.createElement(u,{data:e.sysData,onSubmit:(e,t)=>this.handleFieldUpdate("system",e,t)}):null}render(){return i.default.createElement(s.default.Pad,null,this.conditional())}}class d extends i.default.Component{submitHandler(e){e.preventDefault();let t=new FormData(e.currentTarget),a=new URL(window.location.href);a.port="64209",a.protocol,this.props.handler.upload(a,t)}render(){return i.default.createElement(s.default.Card,null,i.default.createElement("h2",null,"Upload JSON System"),i.default.createElement("p",null,"Try out your own planetary systems!"),i.default.createElement("form",{className:"planetary-upload",onSubmit:e=>this.submitHandler(e)},i.default.createElement("input",{type:"file",name:"file"}),i.default.createElement("button",{type:"submit"},"Submit")))}}class c extends i.default.Component{constructor(e){super(e),this.fb=()=>this.sendState("FAST_BACKWARD"),this.pause=()=>this.sendState("PAUSE"),this.play=()=>this.sendState("PLAY"),this.sf=()=>this.sendState("STEP_FORWARD"),this.ff=()=>this.sendState("FAST_FORWARD")}sendState(e){this.props.handler.sendToSim({type:e})}render(){return i.default.createElement(s.default.Card,null,i.default.createElement(s.default.Row,{id:"icons"},i.default.createElement("i",{className:"fa fa-fast-backward",onClick:this.fb}),i.default.createElement("i",{className:"fa fa-pause",onClick:this.pause}),i.default.createElement("i",{className:"fa fa-play",onClick:this.play}),i.default.createElement("i",{className:"fa fa-step-forward",onClick:this.sf}),i.default.createElement("i",{className:"fa fa-fast-forward",onClick:this.ff})))}}class u extends i.default.Component{render(){return i.default.createElement(i.default.Fragment,null,i.default.createElement("h1",null,"SYSTEM"),i.default.createElement(s.default.InputValue,{label:"Gravity Constant",onSubmit:this.props.onSubmit,inputs:[{tag:"gravityConstant",value:this.props.data.gravityConstant}]}),i.default.createElement(s.default.InputValue,{label:"Scale",onSubmit:this.props.onSubmit,inputs:[{tag:"scale",value:this.props.data.scale}]}),i.default.createElement(s.default.InputValue,{label:"Time Scale",onSubmit:this.props.onSubmit,inputs:[{value:this.props.data.timeScale}]}),i.default.createElement(s.default.InputValue,{label:"Body Scale",onSubmit:this.props.onSubmit,inputs:[{tag:"bodyScale",value:this.props.data.bodyScale}]}),i.default.createElement(s.default.InputValue,{label:"Central Body Scale",onSubmit:this.props.onSubmit,inputs:[{tag:"centralBodyScale",value:this.props.data.centralBodyScale}]}),i.default.createElement(s.default.InputValue,{label:"Elasticity",onSubmit:this.props.onSubmit,inputs:[{tag:"elasticity",value:this.props.data.elasticity}]}),i.default.createElement(s.default.InputValue,{label:"Central Body Name",onSubmit:this.props.onSubmit,inputs:[{value:this.props.data.centralBodyName}]}),i.default.createElement(s.default.InputValue,{label:"Hand Mass",onSubmit:this.props.onSubmit,inputs:[{value:this.props.data.handMass}]}),i.default.createElement(s.default.InputValue,{label:"Boundary",onSubmit:this.props.onSubmit,inputs:[{tag:"boundary",value:this.props.data.boundary}]}))}}class h extends i.default.Component{render(){return i.default.createElement(i.default.Fragment,null,i.default.createElement("h1",null,this.props.data.name.toUpperCase()),i.default.createElement(s.default.InputValue,{label:"Mass",onSubmit:this.props.onSubmit,inputs:[{tag:"mass",value:this.props.data.mass}]}),i.default.createElement(s.default.InputValue,{label:"Radius",onSubmit:this.props.onSubmit,inputs:[{tag:"radius",value:this.props.data.radius}]}),i.default.createElement(s.default.InputValue,{label:"Location",onSubmit:this.props.onSubmit,inputs:[{tag:"location[0]",value:this.props.data.location[0]},{tag:"location[1]",value:this.props.data.location[1]},{tag:"location[2]",value:this.props.data.location[2]}]}),i.default.createElement(s.default.InputValue,{label:"Orbit Radius",onSubmit:this.props.onSubmit,inputs:[{tag:"orbitRadius",value:this.props.data.orbitRadius}]}),i.default.createElement(s.default.InputValue,{label:"Orbit Speed",onSubmit:this.props.onSubmit,inputs:[{tag:"orbitSpeed",value:this.props.data.orbitSpeed}]}),i.default.createElement(s.default.InputValue,{label:"Location",onSubmit:this.props.onSubmit,inputs:[{tag:"direction[0]",value:this.props.data.direction[0]},{tag:"direction[1]",value:this.props.data.direction[1]},{tag:"direction[2]",value:this.props.data.direction[2]}]}))}}},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UsersHandler=void 0;const s=a(3),i=n(a(0)),r=a(42);class o extends s.EventHandler{constructor(e,t,a){super(),this.client=e,this.ui=t,this.tabComponent=a,this.users=[],this.tab=this.tabComponent.addTab("users","Users"),this.render()}onClose(e){this.ui.clear(),this.tabComponent.removeTab("users"),this.tab=void 0,this.users.length=0}onHello(e){this.client.sendJSON({type:"CLIENT_FETCH_ALL"}),this.render()}onClientFetchAllResult(e){this.ui.clear();for(let t of e.clients)this.ui.addIcon(t.uuid,t.nickname||t.name),this.users.push(t)}onStatus(e){switch(e.code){case"CLIENT_JOINED":this.addClient(e);break;case"CLIENT_LEFT":this.removeUser(e.uuid)}}addClient(e){this.ui.addIcon(e.uuid,e.nickname||e.name),this.users.push(e),this.render()}removeUser(e){this.ui.removeIcon(e);for(let t=0;t<this.users.length;t++)this.users[t].uuid==e&&(this.users.splice(t,1),t--);this.render()}render(){this.tab&&(this.tab.reactContent=i.default.createElement(r.UsersTabComponent,{name:this.client.name,uuid:this.client.uuid,users:this.users}))}}t.UsersHandler=o},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UsersTabComponent=void 0;const s=n(a(4)),i=n(a(0));class r extends i.default.PureComponent{render(){return this.props.nickname?i.default.createElement(s.default.Card,null,i.default.createElement("h2",null,this.props.nickname),i.default.createElement("p",null,this.props.name),i.default.createElement("p",null,this.props.uuid),i.default.createElement(s.default.Card,null,this.props.tags)):i.default.createElement(s.default.Card,null,i.default.createElement("h2",null,this.props.name),i.default.createElement("p",null,this.props.uuid),i.default.createElement(s.default.Card,null,this.props.tags))}}class o extends i.default.PureComponent{render(){return i.default.createElement("div",{className:"rstyled full"},i.default.createElement(s.default.Pad,{light:!0},i.default.createElement("h1",null,this.props.name),i.default.createElement("p",null,this.props.uuid)),i.default.createElement(s.default.Pad,{style:{flexGrow:1}},this.props.users.map(e=>i.default.createElement(r,Object.assign({},e)))))}}t.UsersTabComponent=o},function(e,t,a){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.hasOwnProperty.call(e,a)&&n(t,e,a);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=t.RendererView=void 0;const r=i(a(5)),o=a(5);class l{constructor(e,t,a){this.renderer=e,this.canvas=t,this.scene=a,this.isFocused=!1,t.addEventListener("click",()=>{this.isFocused||(this.attachControl(),this.isFocused=!0)}),t.addEventListener("blur",()=>{this.detachControl(),this.isFocused=!1})}universalCamera(){let e=new r.UniversalCamera("UniversalCamera",new o.Vector3(0,15,-15),this.scene);e.setTarget(new o.Vector3(0,0,0)),e.speed=.5,e.keysDownward.push(17,16),e.keysUpward.push(32),e.keysUp.push(87,38),e.keysDown.push(83,40),e.keysLeft.push(65,37),e.keysRight.push(68,39),this.setCamera(e)}arcRotateCamera(){let e=new r.ArcRotateCamera("ArcCamera",Math.PI,Math.PI,15,o.Vector3.Zero(),this.scene);e.setPosition(new o.Vector3(0,5,15)),e.speed=.25,e.keysUp.push(87,38),e.keysDown.push(83,40),e.keysLeft.push(65,37),e.keysRight.push(68,39),this.setCamera(e)}setCamera(e){this.camera&&(this.scene.removeCamera(this.camera),this.camera.dispose()),this.detachControl(),this.camera=e,this.scene.addCamera(e),this.scene.activeCamera=e,this.renderer.engine.registerView(this.canvas,e),this.attachControl()}attachControl(){console.log("Attach"),this.renderer.engine.inputElement=this.canvas,this.scene.attachControl(!0,!0,!0),this.camera&&this.camera.attachControl(this.canvas,!1)}detachControl(){console.log("Detach"),this.scene.detachControl(),this.camera&&this.camera.detachControl(this.canvas)}}t.RendererView=l;t.Renderer=class{constructor(){this.views=[];let e=document.createElement("canvas").getContext("webgl");this.engine=new r.Engine(e,!0)}createView(e){let t=new r.Scene(this.engine);new r.PointLight("light1",new r.Vector3(0,500,0),t).intensity=1;let a=t.createDefaultEnvironment({skyboxSize:500,groundSize:500,groundShadowLevel:.5,enableGroundShadow:!0});a.skybox.isPickable=!1,a.setMainColor(r.Color3.FromHexString("#909090"));let n=new l(this,e,t);return this.views.push(n),n}start(){this.engine.runRenderLoop(()=>{var e;for(const t of this.views)(null===(e=this.engine.activeView)||void 0===e?void 0:e.target)===t.canvas&&t.scene.render()}),window.addEventListener("resize",()=>{this.engine.resize()})}stop(){this.engine.stopRenderLoop()}}},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.About=void 0;const s=n(a(0)),i=n(a(4));t.About=function(){return s.default.createElement("div",{className:"rstyled full"},s.default.createElement(i.default.Pad,{light:!0},s.default.createElement("h1",null,"ERT Concierge"),s.default.createElement("h2",null,"BabylonJS Client")),s.default.createElement(i.default.Pad,{style:{flexGrow:1}},s.default.createElement(i.default.Card,null,s.default.createElement("h2",null,"An Tran"),s.default.createElement("p",null,"Intern")),s.default.createElement(i.default.Card,null,s.default.createElement("h2",null,"Santiago Lombeyda"),s.default.createElement("p",null,"Mentor")),s.default.createElement(i.default.Card,null,s.default.createElement("h2",null,"Front-End"),s.default.createElement("p",null,"Pug/SCSS/TypeScript"),s.default.createElement("p",null,"Webpack + ReactJS")),s.default.createElement(i.default.Card,null,s.default.createElement("h2",null,"Back-End"),s.default.createElement("p",null,"Rust"))),s.default.createElement(i.default.Pad,{light:!0},s.default.createElement("p",null,"SURF 2020 / OVRAS")))}},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GroupsHandler=void 0;const s=a(3),i=n(a(0)),r=a(46);class o extends s.EventHandler{constructor(e,t){super(),this.client=e,this.tabComponent=t,this.groups=[],this.tab=this.tabComponent.addTab("groups","Groups"),this.render()}onClose(e){this.groups.length=0}onHello(e){this.client.sendJSON({type:"GROUP_FETCH_ALL"}),this.render()}onGroupFetchAllResult(e){this.groups.length=0;for(const t of e.groups)this.addGroup(t)}onGroupFetchResult(e){this.removeGroup(e.name),this.addGroup(e)}onStatus(e){switch(e.code){case"GROUP_CREATED":this.client.sendJSON({type:"GROUP_FETCH",name:e.name});break;case"GROUP_DELETED":this.removeGroup(e.name)}}addGroup(e){this.groups.push(e),this.render()}removeGroup(e){for(let t=0;t<this.groups.length;t++)console.log("Checking",this.groups[t].name),this.groups[t].name==e&&(this.groups.splice(t,1),t--);this.render()}render(){this.tab.reactContent=i.default.createElement(r.GroupsTabComponent,{groups:this.groups})}}t.GroupsHandler=o},function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GroupsTabComponent=void 0;const s=n(a(4)),i=n(a(0));class r extends i.default.PureComponent{render(){return this.props.nickname?i.default.createElement(s.default.Card,null,i.default.createElement("h2",null,this.props.nickname),i.default.createElement("p",null,this.props.name),i.default.createElement("p",null,this.props.owner_uuid),i.default.createElement(s.default.Row,null,i.default.createElement("button",null,"A"),i.default.createElement("button",null,"B"))):i.default.createElement(s.default.Card,null,i.default.createElement("h2",null,this.props.name),i.default.createElement("p",null,this.props.owner_uuid),i.default.createElement(s.default.Row,null,i.default.createElement("button",null,"A"),i.default.createElement("button",null,"B")))}}class o extends i.default.Component{render(){return i.default.createElement("div",{className:"rstyled full"},i.default.createElement(s.default.Pad,{light:!0},i.default.createElement("h1",null,"Groups")),i.default.createElement(s.default.Pad,{style:{flexGrow:1}},this.props.groups.map(e=>i.default.createElement(r,Object.assign({},e)))))}}t.GroupsTabComponent=o}]);